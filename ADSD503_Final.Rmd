---
title: "R Notebook"
output: html_notebook
---

# Data preprocessing

```{r}
## Load and inspect data 

# Load dataset with NA encoded as '?'
df <- read.csv("~/Downloads/heart+disease/processed.cleveland.data", 
               header = FALSE, na.strings = "?")

# Assign column names based on UCI documentation
colnames(df) <- c("age", "sex", "cp", "trestbps", "chol", "fbs", "restecg",
                  "thalach", "exang", "oldpeak", "slope", "ca", "thal", "target")

# View structure and summary
str(df)
summary(df)
```

## Handle missing data

```{r}
# Count missing values per column
sapply(df, function(x) sum(is.na(x)))

# Define mode imputation function
impute_mode <- function(x) {
  ux <- unique(x[!is.na(x)])
  ux[which.max(tabulate(match(x, ux)))]
}

# Impute 'ca' and 'thal' (categorical variables with missing values)
df$ca <- ifelse(is.na(df$ca), impute_mode(df$ca), df$ca)
df$thal <- ifelse(is.na(df$thal), impute_mode(df$thal), df$thal)
```

```{r}
# Binarize the 'target' variable: 0 = No Disease, 1â€“4 = Disease
df$target <- ifelse(df$target == 0, 0, 1)
df$target <- factor(df$target, levels = c(0, 1), labels = c("No Disease", "Disease"))
```

```{r}
# Normalize numerical features

library(caret)

# Identify numeric columns
num_vars <- c("age", "trestbps", "chol", "thalach", "oldpeak")

# Apply standardization (center + scale)
preproc <- preProcess(df[, num_vars], method = c("center", "scale"))
df[, num_vars] <- predict(preproc, df[, num_vars])

# Confirm structure and summary statistics post-processing
str(df)
summary(df)
```

## Exploratory Data Analysis (EDA)

```{r}
summary(df)
str(df)
```

```{r}
# Missing values visualization
library(VIM)
aggr(df, col=c('navyblue','red'), numbers=TRUE, sortVars=TRUE)

```
```{r}
# Distributions of numeric variables
library(ggplot2)
ggplot(df, aes(x = age)) + 
  geom_histogram(bins = 30, fill = "steelblue", color = "white")
```

```{r}
# Corrlation heatmap
library(corrplot)
numeric_vars <- df[sapply(df, is.numeric)]
cor_matrix <- cor(numeric_vars, use = "complete.obs")
corrplot(cor_matrix, method = "color", type = "upper")

# Boxplots by variable outcome
ggplot(df, aes(x = factor(target), y = age)) + 
  geom_boxplot()

# Bar plots for categorical variables
ggplot(df, aes(x = factor(cp))) + 
  geom_bar(fill = "coral") +
  labs(title = "Chest Pain Type")
```
```{r}
# Boxplots by variable outcome
ggplot(df, aes(x = factor(target), y = age)) + 
  geom_boxplot()
```

